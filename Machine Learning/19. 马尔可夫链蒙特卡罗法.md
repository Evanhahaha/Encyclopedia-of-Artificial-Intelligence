# 概览

马尔科夫蒙特卡洛法（Markov Chain Monte Carlo, MCMC）经常用在贝叶斯概率模型的推理和学习中，主要是为了解决计算困难的问题。

日常中我们会用采样的方法采集样本，进行近似的数值计算，比如计算样本均值，方差，期望。虽然许多常见的概率密度函数（t 分布，均匀分布，正态分布），我们都可以直接在 Numpy，Scikit-Learn 中找到，但很多时候，一些概率密度函数，特别是高维的概率密度函数，并不是常见的分布，这个时候我们就需要用到 MCMC。

# 蒙特卡洛法 Monte Carlo

蒙特卡洛法是比较宽泛的一系列算法的统称，它的特点是假设概率分布已知，通过重复的随机采样来获得数值结果。比如根据大数定理，我们可以用采样得到的样本计算得到的样本均值来估计总体期望。又比如，积分的运算往往可以表示为随机变量在一个概率密度函数分布上的期望。

# 接受-拒绝法

假设有一个非常复杂不常见的分布 p(x)，我们没有现成的工具包可以调用后进行采样，那么我们可以用我们已经有的采样分布比如高斯分布作为**建议分布(proposal distribution)**，用 **q(x)** 表示，来进行采样，再按照一定的方法来拒绝当前的样本，使得最后得到的样本尽可能的逼近于 **p(x)**。

首先我们需要**找到一个常数 k 使得 kq(x) 一定大于等于 p(x),** 也就是如图所示，p(x) 在 q(x) 下面。接着对 q(x) 进行采样，假设得到的样本为 ![[公式]](https://www.zhihu.com/equation?tex=z_0) 。然后我们按照均匀分布在 ![[公式]](https://www.zhihu.com/equation?tex=%280%2C+kq%28z_0%29%29) 中采样得到 u。如果 u 落到了图中的灰色区域，则拒绝这次采样，否则接受样本 ![[公式]](https://www.zhihu.com/equation?tex=z_0) 。重复这个过程得到一系列的样本 ![[公式]](https://www.zhihu.com/equation?tex=z_0%2Cz_1%2C%E2%80%A6z_n) 。

![MCMC](../img/ML/MCMC.jpg)

